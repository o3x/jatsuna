# AEP Version Checker

After Effectsプロジェクトファイル（.aep）のバージョンを確認するための簡易ツールです。
プロジェクトを実際に開くことなく、どのバージョンのAfter Effectsで保存されたか、どのOSで保存されたかを確認できます。

## 特徴

- **高速確認**: After Effectsを起動する必要がないため、瞬時にバージョンを確認できます。
- **詳細情報**: 単なるバージョン番号だけでなく、ビルド番号や保存時のOSも表示します。
- **複数ファイル対応**: 複数のAEPファイルをまとめてドラッグ＆ドロップして一括確認できます。

## 使い方

1. `aep-version-checker.bat` に、確認したい `.aep` ファイルをドラッグ＆ドロップしてください。
   - 複数のファイルを同時にドロップすることも可能です。
2. コマンドプロンプトが開き、解析結果が表示されます。
3. 確認が終わったら、Enterキーを押してウィンドウを閉じてください。

## 表示される情報について

### Version (内部バージョン)
ファイル構造に記録されているバージョン情報です。
- **CS6以降**: `Major.Minor.Patch.Build` 形式で表示されます。
- **CS5.5以前**: `Major.Minor.Patch` 形式で表示されます。

### Host Version (保存アプリケーションバージョン)
実際にそのファイルを保存したAfter Effectsアプリケーションのバージョンです。
通常は `Version` と同じですが、互換モードなどで保存された場合に異なることがあります。
（CS6以降のファイルでのみ表示されます）

### OS
ファイルが保存された環境のOSです。
- `(Win)`: Windows
- `(Mac)`: macOS

## 技術的な詳細

このツールは、AEPファイルのバイナリヘッダーを解析してバージョン情報を抽出しています。
- **CS5以前**: ヘッダーのオフセット `0x18` 付近のデータを解析
- **CS6以降**: ヘッダーのオフセット `0x24` 付近のデータを解析

## トラブルシューティング

### ウィンドウが一瞬で閉じてしまう
ファイルパスに特殊な文字が含まれている場合や、権限の問題で実行できない場合があります。
バッチファイルをテキストエディタで開き、末尾の `exit` を `pause` に書き換えることで、エラーメッセージを確認できる場合があります。

## 免責事項

- このツールは「オマケ」として同梱されています。
- 動作にはWindows PowerShellが必要です。
- 本ツールに関するサポートは行っておりません。自己責任でご利用ください。
